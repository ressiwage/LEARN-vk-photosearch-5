# vk-photosearch
1. [FAQ](#ะดะปั-ัะตะณะพ-ะฝัะถะตะฝ-ััะพั-ะฟัะพะตะบั)
2. [ะธัะฟะพะปัะทะพะฒะฐะฝะธะต](#ะธัะฟะพะปัะทะพะฒะฐะฝะธะต)
    1. [ะธัะฟะพะปัะทะพะฒะฐะฝะธะต ะฒ ะบะพะปะฐะฑะต](#ะธัะฟะพะปัะทะพะฒะฐะฝะธะต-ะฒ-ะบะพะปะฐะฑะต)
    2. [ัะตะปะตะณัะฐะผ ะฑะพั](#ะธัะฟะพะปัะทะพะฒะฐะฝะธะต-ัะตะปะตะณัะฐะผ-ะฑะพัะฐ)
3. [ัะผะตะฝะฐ ะผะพะดะตะปะธ ัะฐะทะผะตัะบะธ](#ัะผะตะฝะฐ-ะผะพะดะตะปะธ-ัะฐะทะผะตัะบะธ)
4. [ััััะบัััะฐ ะฟัะพะตะบัะฐ](#ััััะบัััะฐ-ะฟัะพะตะบัะฐ)
5. [ะฟัะธะผะตั ะธัะฟะพะปัะทะพะฒะฐะฝะธั](#ะฟัะธะผะตั-ะฟะพะธัะบะฐ-ะฟะพ-ะผะพะธะผ-ัะพััะฐะฝัะฝะฝัะผ-ัะพัะพะณัะฐัะธัะผ)

#### ะดะปั ัะตะณะพ ะฝัะถะตะฝ ััะพั ะฟัะพะตะบั?
ั ัะพะทะดะฐะป ััะพั ะฟัะพะตะบั ะดะปั ะฑััััะพะณะพ ะฟะพะธัะบะฐ ะฟะพ ะดะตัััะบะฐะผ ััััั ัะพัะพะณัะฐัะธะน ะฒ ัะฒะพัะผ ะฐะปัะฑะพะผะต ะฒะบ.

#### ะบะฐะบ ะพะฝ ัะฐะฑะพัะฐะตั?
ะพะฝ ัะบะฐัะธะฒะฐะตั ัะพัะพะณัะฐัะธะธ ะธะท ะฐะปัะฑะพะผะฐ ะฒะบ (ั ะฟะพะผะพััั asyncio, aiohttp), ะทะฐัะตะผ ัะฐะทะผะตัะฐะตั ะธั ั ะฟะพะผะพััั ะผะพะดะตะปะธ blip (ะดะพ ััะพะณะพ ะฑัะปะฐ microsoft/git, ะฝะพ ะพะฝะฐ ะฟะปะพัะพ ัะฟัะฐะฒะปัะปะฐัั), ะฟะพัะปะต ััะพะณะพ ััะฐะฝััะพัะผะธััะตั ะดะฐะฝะฝัะต ะฒ ะฒะตะบัะพัะฐ bag of words ะธ ะฟะพะผะตัะฐะตั ะฒ ััะฐะฝะธะปะธัะต annoy, ะฟะพัะปะต ัะตะณะพ ะธัะตั ะฟะพ ะผะธะฝะธะผะฐะปัะฝะพะผั ัะฐัััะพัะฝะธั ะดะพ ะฑะปะธะถะฐะนัะตะณะพ ะฒะตะบัะพัะฐ. ะฟัะธ ะถะตะปะฐะฝะธะธ ะผะพะถะฝะพ ะทะฐะฟัััะธัั ัะตะปะตะณัะฐะผ ะฑะพั, ะฒ ะบะพัะพัะพะผ ะฑัะดะตั ะดะพัััะฟะตะฝ ัะพะปัะบะพ ะฟะพะธัะบ

#### ััะตะบ
aiohttp, asyncio, torch, transformers, request, annoy, pyTelegramBotAPI

# ะธัะฟะพะปัะทะพะฒะฐะฝะธะต
1. ะฟะตัะตะนะดะธัะต ะฟะพ ัััะปะบะต https://vkhost.github.io/ ะธ ัะบะพะฟะธััะนัะต ัะพะบะตะฝ ะดะปั kate mobile (ะพะฝ ะผะตะถะดั &token= ะธ &expires_in) ะฒ app/config_sample.py, ะทะฐัะตะผ ะฟะตัะตะธะผะตะฝัะนัะต ะตะณะพ ะฒ app/config.py 
2. ัััะฐะฝะพะฒะธัะต ะบัะดั (>12.1)
3. pip install -r requirements.txt
4. python -m spacy download en_core_web_lg
5. python -m app.search_photos.main
6. ัะฝะฐัะฐะปะฐ ัะบะฐัะฐะนัะต ัััะปะบะธ ะฝะฐ ัะฐะนะปั (1 ะพะฟัะธั), ะทะฐัะตะผ ัะฐะผะธ ัะฐะนะปั (2 ะพะฟัะธั), ะฟะพัะปะต ััะพะณะพ ัะฐะทะผะตัััะต ะธั (3 ะพะฟัะธั) ะธ ะฟัะพะธะฝะดะตะบัะธััะนัะต (4 ะพะฟัะธั). ัะพะปัะบะพ ะฟะพัะปะต ััะพะณะพ ะผะพะถะฝะพ ัะพะฒะตััะฐัั ะฟะพะธัะบ

***ะฟัะธ ะฟะพะธัะบะต ะธัะฟะพะปัะทัะนัะต en-us, ะฐ ะฝะต en-uk, ั.ะบ. ัะฐะทะผะตัะบะฐ ะฒะตะดัััั ะฒ en-us***

ะดะปั ัะฐะทะผะตัะบะธ ***ะบัะฐะนะฝะต ะถะตะปะฐัะตะปัะฝะพ*** ะธะผะตัั gpu ะปัััะต gtx 1050

# ะธัะฟะพะปัะทะพะฒะฐะฝะธะต ะฒ ะบะพะปะฐะฑะต
ัะพััะฐะฝะธัะต ัะตะฟะพะทะธัะพัะธะน ะบะฐะบ ะฐััะธะฒ, ะทะฐะณััะทะธัะต ะฒ ัะตะบัััั ะดะธัะตะบัะพัะธั ะฒ ะบะพะปะฐะฑะต, ัะบะพะฟะธััะนัะต ะฝะพััะฑัะบ colab.ipynb ะฒ ัั ะถะต ะดะธัะตะบัะพัะธั ะธ ะทะฐะฟัััะธัะต ะฟะตัะฒัั ััะตะนะบั. ะทะฐัะตะผ ะดะพะฑะฐะฒััะต ะฒ config.py ัะพะบะตะฝ ะธ ัะผะตะฝะธัะต interactive ะฝะฐ False.

ััะพะฑั ัะตะทัะปััะฐั ัะพััะฐะฝะธะปัั ัะธะฝััะพะฝะธะทะธััะนัะตัั ั ะณะดะธัะบะพะผ

# ะธัะฟะพะปัะทะพะฒะฐะฝะธะต ัะตะปะตะณัะฐะผ ะฑะพัะฐ
1. ะฒัะฟะพะปะฝะธัะต ัะฐะณะธ ะธะท "ะธัะฟะพะปัะทะพะฒะฐะฝะธะต"
2. ะทะฐะผะตะฝะธัะต ะฒ app/config.py tg_token ะฝะฐ ัะพะบะตะฝ ะฑะพัะฐ ะธ ะดะพะฑะฐะฒััะต ะฒ allowed_ids ะฒะฐั ัะทะตัะฝะตะนะผ (ะฝะฐะฟัะธะผะตั, ะตัะปะธ ะฒะฐั id -- @myid, ัะพ allowed_ids ะดะพะปะถะตะฝ ะฒัะณะปัะดะตัั ะบะฐะบ ['myid'])
3. python -m app.tg_bot.main
4. ะพัะฟัะฐะฒััะต ะฑะพัั ะบะพะผะฐะฝะดั /search

## ัะผะตะฝะฐ ะผะพะดะตะปะธ ัะฐะทะผะตัะบะธ
ะดะปั ัะผะตะฝั ะผะพะดะตะปะธ ัะฐะทะผะตัะบะธ ะฒ ะผะพะดัะปะต mark_image ะทะฐะผะตะฝะธัะต chosen_marker ะฝะฐ ัะฒะพะน, ั ัะตะผะธ ะถะต ะฐััะธะฑััะฐะผะธ ะธ ะผะตัะพะดะฐะผะธ

# ััััะบัััะฐ ะฟัะพะตะบัะฐ
~~~
๐ photosearch/
โโ๐ app/
โ โโ๐ config.py    -  ััะฐะฝะธะปะธัะต ัะพะบะตะฝะพะฒ (ะฟะตัะตะธะผะตะฝัะนัะต config-sample.py ะฒ config.py)
โ โโ๐ search_photos/   -   ัะฐะทะผะตัะบะฐ, ะทะฐััะทะบะฐ ะธ ะฟะพะธัะบ ัะพัะพะณัะฐัะธะน
โ โ โโ๐ db.py - ัะฐะฑะพัะฐ ั sqlite
โ โ โโ๐ download_photos.py -   ัะฐะฑะพัะฐ ั vk api
โ โ โโ๐ download_urls.py   -   ัะฐะฑะพัะฐ ั vk api
โ โ โโ๐ find_image.py  -   ัะฐะฑะพัะฐ ั annoy
โ โ โโ๐ main.py    -   ะณะปะฐะฒะฝัะน ะผะพะดัะปั
โ โ โโ๐ mark_image.py  -   ัะฐะฑะพัะฐ ั ะผะพะดะตะปัั ัะฐะทะผะตัะบะธ
โ โ โโ๐ photos.db  -   ััะฐะฝะธะปะธัะต ัััะปะพะบ ะฝะฐ ัะพัะพ ะธ ะธั ะพะฟะธัะฐะฝะธะน
โ โ โโ๐ pick_substitution.py   -   ะทะฐะผะตะฝะฐ ะบะพะฝัะพะปัะฝะพะณะพ ะฒะฒะพะดะฐ ะฟัะธ interactive=false
โ โ โโ๐ vectors/   -   ะฒะตะบัะพัะฝะพะต ััะฐะฝะธะปะธัะต
โ โ โ โโ๐ features -   ััะฐะฝะธะปะธัะต features
โ โ โ โโ๐ vectors.ann  -   ััะฐะฝะธะปะธัะต ะพะฟะธัะฐะฝะธะน ะฒ ะฒะตะบัะพัะฝะพะผ ะฟัะตะดััะฐะฒะปะตะฝะธะธ
โ โ โโ๐ _imports.py    -   ะณะปะพะฑะฐะปัะฝัะต ะบะพะฝััะฐะฝัั ะดะปั ะผะพะดัะปั
โ โโ๐ tg_bot/  -   ัะตะปะตะณัะฐะผ ะฑะพั
โ   โโ๐ main.py    -   ะณะปะฐะฒะฝัะน ะผะพะดัะปั
โ   โโ๐ _imports.py    -   ะณะปะพะฑะฐะปัะฝัะต ะบะพะฝััะฐะฝัั ะดะปั ะผะพะดัะปั
โโ๐ colab.ipynb    -   ัะฐะฑะพัะฐ ะฒ ะบะพะปะฐะฑะต
โโ๐ readme.md  -   ัะตะบัััะธั
โโ๐ requirements.txt   -   ะทะฐะฒะธัะธะผะพััะธ
~~~

# ะฟัะธะผะตั ะฟะพะธัะบะฐ ะฟะพ ะผะพะธะผ ัะพััะฐะฝัะฝะฝัะผ ัะพัะพะณัะฐัะธัะผ

![img1](examples/scr1.jpg)

![img2](examples/scr2.jpg)

![img3](examples/scr3.jpg)

![img4](examples/scr4.jpg)

### ัะพะฐะดะผะฐะฟ
- ~~ัะพะทะดะฐัั ัะณ ะฑะพัะฐ ะดะปั ะฑััััะพะณะพ ะฟะพะธัะบะฐ ัะพัะพะบะฐััะพัะตะบ~~
- ะฟัะธะบัััะธัั ัััะตะบัั cli
- ัะดะตะปะฐัั ัะฐัะฟะพะทะฝะฐะฒะฐะฝะธะต ัะตะบััะฐ (ัะฐะผะพะต ัะปะพะถะฝะพะต)